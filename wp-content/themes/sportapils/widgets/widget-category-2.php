<?phpclass widget_category_2 extends WP_Widget{    /*  Widget #2 Setup  */    public function __construct()    {        parent::__construct(false, $name = esc_html__('Sportapils category block 2.', 'sportapils'), array(            'description' => esc_html__('2. Widget for displaying a category posts', 'sportapils')        ));    }    /*  Display Widget #2  */    public function widget($args, $instance)    {        if (!isset($args['widget_id'])) {            $args['widget_id'] = $this->id;        }        $title = (!empty($instance['title'])) ? $instance['title'] : '';        $title = apply_filters('widget_title', $title, $instance, $this->id_base);        $categories = isset($instance['cats_id']) ? $instance['cats_id'] : '';        $number = (!empty($instance['number'])) ? absint($instance['number']) : 3;        if (!$number) {            $number = 3;        }        $category_link = get_category_link($categories) ? get_category_link($categories) : get_permalink(get_option('page_for_posts'));        global $do_not_duplicate;        $r1 = new WP_Query(apply_filters('widget_posts_args', array(            'post__not_in' => $do_not_duplicate,            'posts_per_page' => 1,            'cat' => $categories,            'post_status' => 'publish',            'ignore_sticky_posts' => true        )));        $r2 = new WP_Query(apply_filters('widget_posts_args', array(            'post__not_in' => $do_not_duplicate,            'posts_per_page' => $number - 1,            'cat' => $categories,            'no_found_rows' => true,            'post_status' => 'publish',            'offset' => 1,            'ignore_sticky_posts' => true        )));        $n = 1;        if ($r1->have_posts()) :            ?>            <div class="posts second relative">                <?php while ($r1->have_posts()) : $r1->the_post(); ?>                    <?php                    $widget_3_big = wp_get_attachment_image_src(get_post_thumbnail_id(), 'full');                    $widget_3_big_mobile = wp_get_attachment_image_src(get_post_thumbnail_id(), 'full');                    if ($widget_3_big) { ?>                        <div class="featured relative">                            <?php if ($title) { ?>                                <div class="main-title centered">                                    <div class="colored-icon"></div>                                    <a class="relative"                                       href="<?php echo $category_link; ?>"><?php echo esc_html($title); ?></a>                                </div>                            <?php } ?>                            <div class="overlay"></div>                            <div class="img-wrapper">                                <img src="<?php echo esc_url($widget_3_big[0]); ?>"                                     alt="<?php the_title_attribute(); ?>">                            </div>                            <div class="content centered">                                <div class="info">                                    <span class="date"><?php echo get_the_date(); ?></span>                                    <span class="author">@<?php echo get_the_author_meta('display_name'); ?></span>                                </div>                                <div class="title-wrapper">                                    <span class="title"><?php echo get_the_title() ?  esc_html(wp_trim_words( the_title('', '', false), 15, ' ...' )) : the_ID(); ?></span>                                </div>                                <div class="button-wrapper">                                    <a class="button colored" href="<?php the_permalink(); ?>"                                       title="<?php the_title_attribute(); ?>">                                        <?php esc_html_e('read post', 'sportapils'); ?>                                    </a>                                </div>                            </div>                        </div>                    <?php } ?>                    <?php                    $n++;                endwhile;                wp_reset_postdata();                ?>                <div class="hexagon-list second relative centered">                    <?php while ($r2->have_posts()) : $r2->the_post(); ?>                        <?php if ($n == 4) { ?>                            <div class="shadow-hexagon">                                <div class="hexTop"></div>                                <div class="hexBottom"></div>                            </div>                        <?php }                            $hexagon_image = wp_get_attachment_image_src(get_post_meta(get_the_ID(), 'hexagon_featured_image', true), 'full');                            if(!$hexagon_image) $hexagon_image = wp_get_attachment_image_src(get_post_thumbnail_id(), 'full');                            if ($hexagon_image) { ?>                                <a href="<?php the_permalink(); ?>" title="<?php the_title_attribute(); ?>"                                   class="hexagon right <?php if ($n == 3) echo 'grey';                                   if ($n == 4) echo 'borderless' ?>"                                   style="background-image: url(<?php echo esc_url($hexagon_image[0]); ?>);">                                    <?php if ($n != 3) { ?><div class="overlay"></div><?php } ?>                                    <div class="content">                                        <div class="info">                                            <span class="date"><?php echo get_the_date(); ?></span>                                            <span class="author">@<?php echo get_the_author_meta('display_name'); ?></span>                                        </div>                                        <div class="title-wrapper">                                            <span class="title"><?php echo get_the_title() ?  esc_html(wp_trim_words( the_title('', '', false), 10, ' ...' )) : the_ID(); ?></span>                                        </div>                                        <div class="description-wrapper">                                        <span class="description">                                            <?php echo esc_html(wp_trim_words(get_the_excerpt(), 22, ' ...')); ?>                                        </span>                                        </div>                                    </div>                                    <div class="hexTop">                                        <?php if ($n != 3) { ?><div class="overlay"></div><?php } ?>                                    </div>                                    <div class="hexBottom">                                        <?php if ($n != 3) { ?><div class="overlay"></div><?php } ?>                                    </div>                                    <?php if ($n == 3) { ?>                                        <div class="hexagon-overlay">                                            <div class="hexTop">                                            </div>                                            <div class="hexBottom">                                            </div>                                        </div>                                    <?php } ?>                                </a>                            <?php } ?>                        <?php $n++ ?>                    <?php endwhile; ?>                </div>                <div class="clearfix"></div>                <div class="button-wrapper list">                    <a class="relative button colored green" href="<?php echo $category_link ;?>"><?php _e( 'More Posts', 'sportapils'); ?></a>                </div>            </div>            <?php            wp_reset_postdata();        endif;    }    /*  Update Widget #2  */    public function update($new_instance, $old_instance)    {        $instance = $old_instance;        $instance['title'] = sanitize_text_field($new_instance['title']);        $instance['number'] = (int)$new_instance['number'];        $instance['cats_id'] = (int)$new_instance['cats_id'];        return $instance;    }    /*  Widget #2 Settings Form  */    public function form($instance)    {        $title = isset($instance['title']) ? esc_attr($instance['title']) : '';        $number = isset($instance['number']) ? absint($instance['number']) : 3;        $cats = get_categories();        $categories = isset($instance['cats_id']) ? $instance['cats_id'] : '';        ?>        <p>            <label for="<?php echo esc_attr($this->get_field_id('title')); ?>"><?php esc_html_e('Title:', 'sportapils'); ?></label>            <input class="widefat" id="<?php echo esc_attr($this->get_field_id('title')); ?>"                   name="<?php echo esc_attr($this->get_field_name('title')); ?>" type="text"                   value="<?php echo esc_attr($title); ?>"/></p>        <p>            <label for="<?php echo esc_attr($this->get_field_id('number')); ?>"><?php esc_html_e('Number of post to show:', 'sportapils'); ?></label>            <input class="tiny-text" id="<?php echo esc_attr($this->get_field_id('number')); ?>"                   name="<?php echo esc_attr($this->get_field_name('number')); ?>" type="number" step="1" min="1"                   value="<?php echo esc_attr($number); ?>" size="2"/></p>        <p>            <label for="<?php echo esc_attr($this->get_field_id('cats_id')); ?>"><?php esc_html_e('Select Category:', 'sportapils'); ?></label>            <select id="<?php echo esc_attr($this->get_field_id('cats_id')); ?>"                    name="<?php echo esc_attr($this->get_field_name('cats_id')); ?>">                <option value=""><?php esc_html_e('All', 'sportapils'); ?></option>                <?php foreach ($cats as $cat) { ?>                    <option value="<?php echo esc_attr($cat->term_id); ?>"<?php echo selected($categories, $cat->term_id, false) ?>> <?php echo esc_attr($cat->name) ?></option>                <?php } ?>            </select></p>        <?php    }}add_action('widgets_init', 'widget_category_2_register');function widget_category_2_register(){    register_widget('widget_category_2');}